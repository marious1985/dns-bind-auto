---
- name: Example of lineinfile
  hosts: dns_servers
  vars:
    success: false

  tasks:

    - name: get time

      shell: /usr/bin/date
      register: var_time
    - name: get time serial format

      shell: /usr/bin/date +%Y%m%M%S
      register: var_time_sec

    - name: "locate fqdn and delete if needed"
      become: yes
      become_user: mario
      tags: example1
      lineinfile:
        path: /home/mario/Build/db.test
        regexp: "ps3"
        state: absent
        backup: yes
      #checkmode: yes
      register: delete_fqdn
      
    - name: "update serial bind for propagation"
      lineinfile:
        dest: '/home/mario/Build/db.test'
        regexp: '.Serial\s'
        line: "\t\t\t{{ var_time_sec.stdout }}\t;\tSerial"
        state: 'present'
      when: delete_fqdn.changed